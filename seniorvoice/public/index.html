<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="SeniorVoice â€” Nour, l'assistante vocale pour les aÃ®nÃ©s tunisiens">
  <meta name="theme-color" content="#2563eb">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="SeniorVoice">
  <title>SeniorVoice â€” Nour</title>
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%232563eb'/><text y='.9em' font-size='70' x='15'>ğŸ™ï¸</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
</head>
<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 0 â€” ONBOARDING
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-onboarding">
    <div class="onboarding-container">
      <!-- Progress dots -->
      <div class="onboarding-dots" id="onboarding-dots">
        <span class="dot active" data-step="1"></span>
        <span class="dot" data-step="2"></span>
        <span class="dot" data-step="3"></span>
        <span class="dot" data-step="4"></span>
        <span class="dot" data-step="5"></span>
      </div>

      <!-- STEP 1 â€” NAME -->
      <div class="onboarding-step active" id="ob-step-1">
        <div class="ob-icon">ğŸ‘‹</div>
        <h1 class="ob-title">Bienvenue !</h1>
        <p class="ob-subtitle">Comment vous appelez-vous ?</p>
        <div class="ob-form">
          <input type="text" class="ob-input" id="ob-name" placeholder="Votre prÃ©nom" autocomplete="given-name">
          <button class="ob-voice-btn" id="ob-name-voice">ğŸ™ï¸ Dire mon prÃ©nom</button>
        </div>
      </div>

      <!-- STEP 2 â€” MEDICATIONS -->
      <div class="onboarding-step" id="ob-step-2">
        <div class="ob-icon">ğŸ’Š</div>
        <h1 class="ob-title">Vos mÃ©dicaments</h1>
        <p class="ob-subtitle">Ajoutez les mÃ©dicaments que vous prenez</p>
        <div class="ob-form">
          <input type="text" class="ob-input" id="ob-med-name" placeholder="Nom (ex: Amlor)">
          <input type="text" class="ob-input" id="ob-med-dose" placeholder="Dose (ex: 5mg)">
          <div class="ob-schedule-row">
            <label class="ob-check"><input type="checkbox" id="ob-med-matin"> Matin</label>
            <label class="ob-check"><input type="checkbox" id="ob-med-midi"> Midi</label>
            <label class="ob-check"><input type="checkbox" id="ob-med-soir"> Soir</label>
            <label class="ob-check"><input type="checkbox" id="ob-med-nuit"> Nuit</label>
          </div>
          <button class="ob-add-btn" id="ob-add-med">+ Ajouter</button>
        </div>
        <div class="ob-list" id="ob-med-list"></div>
        <button class="ob-skip-link" id="ob-skip-meds">Passer â†’</button>
      </div>

      <!-- STEP 3 â€” CONTACTS -->
      <div class="onboarding-step" id="ob-step-3">
        <div class="ob-icon">ğŸ‘¥</div>
        <h1 class="ob-title">Vos contacts importants</h1>
        <p class="ob-subtitle">Ajoutez vos proches pour les appeler facilement</p>
        <div class="ob-form">
          <input type="text" class="ob-input" id="ob-con-name" placeholder="PrÃ©nom (ex: Mohamed)">
          <input type="text" class="ob-input" id="ob-con-nick" placeholder="Surnom en arabe (ex: ÙˆÙ„Ø¯ÙŠ)" dir="auto">
          <input type="tel" class="ob-input" id="ob-con-phone" placeholder="TÃ©lÃ©phone (ex: +21698000000)">
          <label class="ob-check ob-emergency-check">
            <input type="checkbox" id="ob-con-emergency"> â­ Contact d'urgence
          </label>
          <button class="ob-add-btn" id="ob-add-con">+ Ajouter</button>
        </div>
        <div class="ob-list" id="ob-con-list"></div>
        <p class="ob-hint" id="ob-con-hint">ğŸ’¡ RecommandÃ© : ajoutez au moins un contact d'urgence</p>
      </div>

      <!-- STEP 4 â€” APPOINTMENTS -->
      <div class="onboarding-step" id="ob-step-4">
        <div class="ob-icon">ğŸ“…</div>
        <h1 class="ob-title">Vos rendez-vous</h1>
        <p class="ob-subtitle">Ajoutez vos prochains rendez-vous mÃ©dicaux</p>
        <div class="ob-form">
          <input type="text" class="ob-input" id="ob-apt-title" placeholder="Titre (ex: Cardiologue)">
          <input type="text" class="ob-input" id="ob-apt-doctor" placeholder="Nom du mÃ©decin">
          <input type="date" class="ob-input" id="ob-apt-date">
          <input type="time" class="ob-input" id="ob-apt-time">
          <button class="ob-add-btn" id="ob-add-apt">+ Ajouter</button>
        </div>
        <div class="ob-list" id="ob-apt-list"></div>
        <button class="ob-skip-link" id="ob-skip-apts">Passer â†’</button>
      </div>

      <!-- STEP 5 â€” SMART HOME -->
      <div class="onboarding-step" id="ob-step-5">
        <div class="ob-icon">ğŸ </div>
        <h1 class="ob-title">Maison connectÃ©e</h1>
        <p class="ob-subtitle">Optionnel â€” passez si vous n'avez pas Home Assistant</p>
        <div class="ob-form">
          <input type="url" class="ob-input" id="ob-ha-url" placeholder="URL Home Assistant (ex: http://192.168.1.x:8123)">
          <input type="password" class="ob-input" id="ob-ha-token" placeholder="Token d'accÃ¨s longue durÃ©e">
        </div>
        <button class="ob-skip-prominent" id="ob-skip-ha">Passer â†’</button>
      </div>

      <!-- FINISH -->
      <div class="onboarding-step" id="ob-step-finish">
        <div class="ob-finish-check">âœ…</div>
        <h1 class="ob-title" id="ob-finish-title">Bonjour ! Nour est prÃªte. ğŸ‘‹</h1>
        <p class="ob-subtitle">Votre assistante personnelle vous attend</p>
        <button class="ob-start-btn" id="ob-start">Commencer â†’</button>
      </div>

      <!-- Navigation buttons -->
      <div class="ob-nav" id="ob-nav">
        <button class="ob-back-btn" id="ob-back">â† Retour</button>
        <button class="ob-next-btn" id="ob-next">Suivant â†’</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOP BAR (hidden on onboarding)
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header class="topbar" id="topbar">
    <div class="topbar-brand">
      <span class="topbar-logo">ğŸ™ï¸</span>
      <span class="topbar-title">SeniorVoice</span>
    </div>
    <button class="topbar-btn" id="btn-topbar-settings" aria-label="ParamÃ¨tres">âš™ï¸</button>
  </header>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PROACTIVE ALERT BANNER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="alert-banner hidden" id="alert-banner">
    <span class="alert-text" id="alert-text"></span>
    <button class="alert-dismiss" id="alert-dismiss" aria-label="Fermer">Ã—</button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1 â€” MAIN
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen active" id="screen-main">

    <!-- Greeting -->
    <div class="greeting" id="greeting">
      <h1 class="greeting-name" id="greeting-name">Bonjour ğŸ‘‹</h1>
      <p class="greeting-sub" id="greeting-sub">Bonne matinÃ©e !</p>
    </div>

    <!-- Mic Area -->
    <div class="mic-area">
      <div class="pulse-ring" id="pulse-ring"></div>
      <button class="mic-btn" id="mic-btn" aria-label="Appuyer pour parler">
        <span class="mic-icon" id="mic-icon">ğŸ™ï¸</span>
        <div class="mic-spinner hidden" id="mic-spinner"></div>
      </button>
      <div class="mic-label" id="mic-label">Appuyer pour parler</div>
      <div class="mic-nour">Sama</div>
    </div>

    <!-- Transcript Card -->
    <div class="card card-transcript hidden" id="card-transcript">
      <div class="card-label">Vous avez dit :</div>
      <div class="transcript-text" id="transcript-text"></div>
      <span class="lang-badge" id="lang-badge">FR</span>
    </div>

    <!-- Agent Progress -->
    <div class="card card-progress hidden" id="card-progress">
      <div class="card-label">Sama rÃ©flÃ©chitâ€¦</div>
      <div class="tool-list" id="tool-list"></div>
    </div>

    <!-- Result Card -->
    <div class="card card-result hidden" id="card-result">
      <div class="result-understood" id="result-understood"></div>
      <div class="result-response" id="result-response"></div>
      <div class="result-actions">
        <button class="btn btn-confirm" id="btn-confirm">âœ… Oui, merci</button>
        <button class="btn btn-retry" id="btn-retry">ğŸ”„ RÃ©pÃ©ter</button>
      </div>
    </div>

    <!-- Clarification Card -->
    <div class="card card-clarification hidden" id="card-clarification">
      <div class="clarification-icon">ğŸ¤”</div>
      <div class="clarification-question" id="clarification-question"></div>
      <div class="clarification-actions">
        <button class="btn btn-mic-clarify" id="btn-mic-clarify">ğŸ™ï¸ RÃ©pondre</button>
        <div class="clarification-type-row">
          <input type="text" class="clarification-input" id="clarification-input" placeholder="Ou tapez votre rÃ©ponseâ€¦">
          <button class="btn btn-type-clarify" id="btn-type-clarify">â†’</button>
        </div>
      </div>
    </div>

  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 2 â€” DASHBOARD
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-dashboard">
    <div class="screen-scroll">
      <h2 class="section-title">ğŸ“Š Tableau de bord</h2>

      <div class="dash-card">
        <div class="dash-card-title">ğŸ’Š MÃ©dicaments d'aujourd'hui</div>
        <div id="dash-meds-list"></div>
      </div>

      <div class="dash-card">
        <div class="dash-card-title">ğŸ“… Prochains rendez-vous</div>
        <div id="dash-apts-list"></div>
        <button class="dash-add-link" onclick="showScreen('screen-medications')">+ Ajouter â†’</button>
      </div>

      <div class="dash-card">
        <div class="dash-card-title">âš¡ Actions rapides</div>
        <div class="quick-actions">
          <button class="quick-btn" id="qa-call">ğŸ“<span>Famille</span></button>
          <button class="quick-btn" id="qa-weather">ğŸŒ¤ï¸<span>MÃ©tÃ©o</span></button>
          <button class="quick-btn" id="qa-news">ğŸ“°<span>ActualitÃ©s</span></button>
          <button class="quick-btn" id="qa-meds">ğŸ’Š<span>MÃ©dicaments</span></button>
        </div>
      </div>

      <div class="dash-card">
        <div class="dash-card-title">ğŸ• ActivitÃ© rÃ©cente</div>
        <div id="dash-history-list"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 3 â€” CONTACTS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-contacts">
    <div class="screen-scroll">
      <div class="screen-header-row">
        <h2 class="section-title">ğŸ‘¥ Contacts</h2>
        <button class="btn-add-item" id="btn-add-contact">+ Ajouter</button>
      </div>
      <div id="contacts-list"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 4 â€” MEDICATIONS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-medications">
    <div class="screen-scroll">
      <div class="screen-header-row">
        <h2 class="section-title">ğŸ’Š MÃ©dicaments</h2>
        <button class="btn-add-item" id="btn-add-med">+ Ajouter</button>
      </div>

      <div class="meds-section-title">Aujourd'hui</div>
      <div id="meds-today-list"></div>

      <div class="meds-section-title">Tous les mÃ©dicaments</div>
      <div id="meds-all-list"></div>

      <div class="meds-section-title">Historique (7 jours)</div>
      <div id="meds-history-list"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 5 â€” HISTORY
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-history">
    <div class="screen-scroll">
      <div class="screen-header-row">
        <h2 class="section-title">ğŸ“‹ Historique</h2>
        <button class="btn-danger-sm" id="btn-clear-history">ğŸ—‘ï¸ Effacer</button>
      </div>
      <div class="history-filter">
        <button class="filter-btn active" data-filter="all">Tout</button>
        <button class="filter-btn" data-filter="reminder">â° Rappels</button>
        <button class="filter-btn" data-filter="call">ğŸ“ Appels</button>
        <button class="filter-btn" data-filter="medication">ğŸ’Š MÃ©dicaments</button>
        <button class="filter-btn" data-filter="weather">ğŸŒ¤ï¸ MÃ©tÃ©o</button>
      </div>
      <div id="history-list"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 6 â€” SETTINGS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="screen" id="screen-settings">
    <div class="screen-scroll">
      <h2 class="section-title">âš™ï¸ ParamÃ¨tres</h2>

      <!-- Profile -->
      <div class="settings-group">
        <div class="settings-group-title">ğŸ‘¤ Profil</div>
        <div class="form-field">
          <label class="form-label">Votre prÃ©nom</label>
          <input type="text" class="form-input" id="settings-name" placeholder="Votre prÃ©nom">
        </div>
        <button class="btn btn-save" id="btn-save-profile">ğŸ’¾ Enregistrer</button>
      </div>


      <!-- Voice -->
      <div class="settings-group">
        <div class="settings-group-title">ğŸ”Š Voix</div>
        <div class="form-field">
          <label class="form-label">Vitesse de la voix</label>
          <div class="range-row">
            <span class="range-label">Lent</span>
            <input type="range" class="form-range" id="settings-speed" min="0.6" max="1.2" step="0.05" value="0.82">
            <span class="range-label">Rapide</span>
          </div>
        </div>
        <button class="btn btn-test" id="btn-test-voice">ğŸ”Š Tester la voix</button>
      </div>

      <!-- Smart Home -->
      <div class="settings-group">
        <div class="settings-group-title">ğŸ  Maison connectÃ©e</div>
        <div class="form-field">
          <label class="form-label">URL Home Assistant</label>
          <input type="url" class="form-input" id="settings-ha-url" placeholder="http://192.168.1.x:8123">
        </div>
        <div class="form-field">
          <label class="form-label">Token d'accÃ¨s</label>
          <div class="key-row">
            <input type="password" class="form-input" id="settings-ha-token" placeholder="Token longue durÃ©e">
            <button class="show-key-btn" data-target="settings-ha-token">ğŸ‘ï¸</button>
          </div>
        </div>
        <button class="btn btn-save" id="btn-save-settings">ğŸ’¾ Enregistrer tout</button>
      </div>

      <!-- Danger Zone -->
      <div class="settings-group settings-danger">
        <div class="settings-group-title">âš ï¸ Zone de danger</div>
        <button class="btn btn-danger" id="btn-reset-all">ğŸ—‘ï¸ RÃ©initialiser toutes les donnÃ©es</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BOTTOM NAVIGATION
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <nav class="bottom-nav" id="bottom-nav">
    <button class="nav-tab active" data-screen="screen-main">
      <span class="nav-icon">ğŸ™ï¸</span>
      <span class="nav-label">Samar</span>
    </button>
    <button class="nav-tab" data-screen="screen-dashboard">
      <span class="nav-icon">ğŸ“Š</span>
      <span class="nav-label">Tableau</span>
    </button>
    <button class="nav-tab" data-screen="screen-contacts">
      <span class="nav-icon">ğŸ‘¥</span>
      <span class="nav-label">Contacts</span>
    </button>
    <button class="nav-tab" data-screen="screen-medications">
      <span class="nav-icon">ğŸ’Š</span>
      <span class="nav-label">MÃ©dicaments</span>
    </button>
    <button class="nav-tab" data-screen="screen-settings">
      <span class="nav-icon">âš™ï¸</span>
      <span class="nav-label">ParamÃ¨tres</span>
    </button>
  </nav>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EMERGENCY OVERLAY
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="emergency-overlay hidden" id="emergency-overlay">
    <div class="emergency-content">
      <div class="emergency-siren">ğŸš¨</div>
      <div class="emergency-title">APPEL D'URGENCE</div>
      <div class="emergency-number" id="emergency-number">190</div>
      <div class="emergency-symptoms" id="emergency-symptoms"></div>
      <div class="emergency-countdown" id="emergency-countdown">Appel dans 3â€¦</div>
      <button class="emergency-cancel" id="emergency-cancel">Annuler</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL OVERLAY
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay hidden" id="modal-overlay">
    <div class="modal-box" id="modal-box">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">Ajouter</h3>
        <button class="modal-close" id="modal-close">Ã—</button>
      </div>
      <div class="modal-body" id="modal-body"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="toast" id="toast"></div>

  <!-- App Logic -->
  <script src="./app.js"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.warn('SW failed:', err));
      });
    }
  </script>
</body>
</html>
